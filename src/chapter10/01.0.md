#### 系统的cpu使用率很高，但是为啥找不到高cpu的应用？

通常情况下遇到服务器的cpu使用率升高我们都是会用`top`或者`htop`命令去分析.

但是在top界面，我们偶尔可能会发现有的是cpu占有率70%.而且一直居高不下.

这里我们简单展示下,然后通过 `pidstat`详细查看下进程.
```bash
> pidstat -p 6271
Linux 3.10.0-957.21.2.el7.x86_64 (zqg-es-101) 	06/21/2020 	_x86_64_	(16 CPU)

04:25:24 PM   UID       PID    %usr %system  %guest    %CPU   CPU  Command
04:25:24 PM     0      6271    1.33    0.77    0.00    78     9    node
```

造成这种情况有两个原因：

1.进程在不停的重启（段错误或配置错误）

2.这些进程都是短时进程，也就是在其他应用内部通过 exec 调用的外面命令。

 
这个node看起来像是被其他进程调用的短时进程。我们可以用`pstree`树状形式展示所有进程之间的关系.

我们也可以用`perf record -g `,记录性能事件，然后使用 `perf report`查看.

execsnoop 就是一个专为短时进程设计的工具。它通过 ftrace 实时监控进程的 exec() 行为，并输出短时进程的基本信息，包括进程 PID、父进程 PID、命令行参数以及执行的结果。

